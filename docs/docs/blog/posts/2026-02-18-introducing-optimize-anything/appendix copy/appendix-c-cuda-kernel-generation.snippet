<span id="appendix-c-cuda-kernel-generation"></span>
??? example "CUDA Kernel Generation"

    Multi-task search over KernelBench problems. A shared prompt is optimized to instruct an LLM to generate fast, correct CUDA kernels across multiple algorithms. The `RefinerConfig` enables automatic per-evaluation refinement â€” after each evaluation, an LLM proposes a refined candidate based on the feedback.

    ```python
    from gepa.optimize_anything import optimize_anything, GEPAConfig, EngineConfig, RefinerConfig

    def evaluate(candidate, example):
        baseline = baselines[example.problem_id]
        code, cuda_docs, eval_result = run_kernel(
            candidate["kernel_gen_prompt"], example.ref_arch, lm, predictor
        )
        score = compute_score(eval_result, baseline)

        runtime = eval_result.get("PerformanceStatsMean")
        side_info =  {
            "score": score,
            "problem_id": example.problem_id,
            "level": example.level,
            "baseline_ms": baseline,
            "code": code,
            "cuda_docs": cuda_docs,
            "runtime_ms": runtime,
            "speedup": baseline / runtime if runtime else None,
            "is_correct": eval_result.get("CorrectnessSucceeded", False),
            "error_feedback": format_error(eval_result) if eval_result.get("ErrorType") else None,
        }

    optimize_anything(
        seed_candidate={"kernel_gen_prompt": KERNEL_GEN_PROMPT},
        evaluator=evaluate,
        dataset=dataset,  # multiple KernelBench problems
        config=GEPAConfig(
            engine=EngineConfig(max_metric_calls=2000, cache_evaluation=True),
            refiner=RefinerConfig(),  # auto-refine after each evaluation
        ),
        objective=OBJECTIVE,
        background=BACKGROUND,
    )
    ```

    <!-- @luke:
    A few things to note:
    - Artifact: kernel generation prompt
    - Dataset = None -> objective suffices
    - Background : your suggestions / constraints / etc.
    - refiner
    - ASI -->

    ??? example "Optimized artifact"
        ```python
        this is a test python code. 
        ```

